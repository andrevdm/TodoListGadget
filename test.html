<html >
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=Unicode" />
        <title>TodoList</title>
		<link type="text/css" href="jqueryui/css/ui-lightness/jquery-ui-1.8rc3.custom.css" rel="stylesheet" />	
		<link type="text/css" href="stickyFooter.css" rel="stylesheet" />	
		<link type="text/css" href="todo.css" rel="stylesheet" />	
		<script type="text/javascript" src="jquery-1.4.1.js"></script>
		<script type="text/javascript" src="jqueryui/js/jquery-ui-1.8rc3.custom.min.js"></script>
		<script type="text/javascript" src="Gadget.js"></script>
		<script type="text/javascript" src="todoParser.js"></script>
		<script type="text/javascript" src="dataTemplate.js"></script>
		<script type="text/javascript" src="todo.js"></script>
		<script type="text/javascript">
			//-----------------
			//Config
			//-----------------
			var m_todoFiles = new Array();
			var m_refreshMinutes = 5
			var m_defaultTimeHour = 8
			var m_defaultTimeMinute = 0
			var m_priorityColours = ["#1EE100", "#00E43F", "#00E7A0", "#00D1EA", "#0071ED", "#000FF0", "#5400F3", "#BA00F6", "#F900CD", "#FC0068", "#FF0000"]
			//-----------------		
		
			$(document).ready(function()
			{
				$('#tabs').tabs();
				
				//Browser hacks to emulate gadgets
				System = new Object();
				System.Debug = new Object();
				System.Debug.outputString = alert
				//
			});
			
			function Init()
			{
				var files = TodoParser.ParseFiles( ["C:\\temp\\a.xml", "c:\\temp\\a2.xml"] )
				
				var projectAll = document.getElementById( "tabs-all" )
				var projectTab = document.getElementById( "tabs-project" )
				
				var output = FormatSections( m_sections, files )
				$('#tabs-all').html(output);
			}
			
			function FormatSections( sections, files )
			{
				var html = ""
			
				for( var s in sections )
				{
					var section = sections[s];
					var filter = function( item ){ return SelectItemsWithDueDate( item ) && section.filter( item ) };
					var items = files.SelectItems( filter );
					items.sort( SortByDueDate );
					
					if( items.length == 0 )
					{
						continue;
					}
					
					html += FormatHeader( section );
					html += $( section.itemTemplate ).parseTemplate( {section:section, items : items} );
				}
				
				return html;
			}
			
			function FormatHeader( section )
			{
				var html = $( section.headerTemplate ).parseTemplate( {section:section} );
				return html
			}
		</script>
		
		<script id="HeaderTemplate" type="text/html">
			<div class="sectionTitle"><#= section.title #></div>
		</script>
		
		<script id="ItemsTwoColumn" type="text/html">
			<table>
				<#
				for( var i in items )
				{
					var item = items[ i ];
					#>
					<tr>
						<td class="tdForTwoCol"><#= section.formatLeftCol( item ) #></td>
						<td class="tdForTwoCol"><#= item.title#></td>
					</tr>
					<#
				}
				#>
			</table>
		</script>
		
		<script id="ItemsList" type="text/html">
			<#
			for( var i in items )
			{
				var item = items[ i ];
				#><#= item.title#><br/><#
			}
			#>
		</script>
		
    </head>
	
    <body onload="Init()" onDblClick="reloadPage()">
        <g:background id="imgBackground">
			<div id="wrap">
				<div id="main" class="clearfix">
					<!--
					<div id="header">
					</div>				
					-->
					
					<div id="tabs">
						<ul>
							<li><a href="#tabs-all">All</a></li>
							<li><a href="#tabs-project">Project</a></li>
						</ul>
						<div id="tabs-all">
						</div>
						
						<div id="tabs-project">
						</div>
					</div>
				</div>
			</div>
			
			<div id="footer" class="customFooter">
				<div id="statusBar">
					footer
				</div>
			</div>
		  
		</g:background>		
    </body>
</html>